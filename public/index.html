<!DOCTYPE html>
<html>
<head>
<script src="/socket.io/socket.io.js"></script>
<script src="jquery.js"></script>
</head>
<body>
<script>
    var socket = io.connect(window.location.origin);
    var touchX, touchY = 0;
    var moveX, moveY = 0;
    var multiplier = 1;
    
    function mult(vector){
      return multiplier * vector;
    }
    
    function tapstart(e){
        touchX = event.changedTouches[0].pageX;
        touchY = event.changedTouches[0].pageY;
    }

    function tapend(e){
        if (touchX == event.changedTouches[0].pageX && touchY == event.changedTouches[0].pageY){
            data = {'x': moveX, 'y': moveY, 'tap': true}
            socket.emit('tap', data)
        }
    }
    
    function move(e) {
        x = event.touches[0].pageX;
        y = event.touches[0].pageY;
        
        deltaX = x - moveX;
        deltaY = y - moveY;
        
        moveX = x;
        moveY = y;
        
        data = {'x': deltaX, 'y': deltaY, 'startX': touchX, 'startY': touchY, 'tap': false}
        socket.emit('move', data)
    }

    $(document).ready(function() {
        $(document).bind('touchstart', tapstart)
        $(document).bind('touchend', tapend)
        $(document).bind('touchmove', move);
    })
</script>
</body>
</html>